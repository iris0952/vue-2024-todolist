import{u as D,r as d,c as L,o as F,a as n,b as l,d as t,t as C,e as N,w as a,f as b,v as x,n as w,g as $,F as P,h as j,i as q}from"./index-DGiUeT1g.js";import{a as H,e as c,b as g,T as v}from"./cookieHandler-vFihtQH5.js";import{u as I}from"./auth-CMLXvSwL.js";const O={id:"todoListPage",class:"bg-half"},R={class:"todo_sm"},G={class:"conatiner todoListPage vhContainer"},J={class:"todoList_Content"},K={class:"inputBox"},Q={class:"todoList_list"},W={class:"todoList_tab"},X={class:"todoList_items"},Y={key:0},Z={class:"todoList_item"},tt={key:0,class:"todoList_label"},et={key:1,class:"todoList_label"},st=["onUpdate:modelValue","onChange"],ot={key:2,class:"todo_btn_group edit_btn_group"},nt=["onClick"],lt={key:3,class:"todo_btn_group nomal_btn_group"},at=["onClick"],it=["onClick"],ut={key:1,class:"todoList_statistics"},ft={__name:"TodoView",setup(rt){const T=D(),f=I(),y=d("all"),p=d({all:"active",todo:"",done:""}),m=e=>{Object.keys(p.value).forEach(s=>{p.value[s]=s===e?"active":""}),y.value=e},r=d([]),V=L(()=>y.value==="todo"?r.value.filter(e=>e.status===!1):y.value==="done"?r.value.filter(e=>e.status===!0):r.value),B=L(()=>r.value.filter(e=>!e.status).length);async function k(){try{const{data:e}=await g.todos.get();r.value=e.data}catch(e){c(e)}}const h=d("");async function M(){try{const e=h.value.trim();if(e.length===0)return v("warning","Todo內容不能為空白"),h.value="";await g.todos.post(e),h.value="",k(),m("all")}catch(e){c(e)}}async function U(e){try{await g.todos.toggle(e.id),e.status?v("success",`已完成：${e.content}`):v("warning",`未完成：${e.content}`)}catch(s){c(s)}}async function E(e){try{await g.todos.delete(e.id),k(),v("success",`已刪除：${e.content}`)}catch(s){c(s)}}const i=d(),_=d("");function S(e){i.value=e,_.value=e.content}async function z(e){try{if(e.content===_.value)return i.value=null;await g.todos.put(e.id,_.value),i.value=null,await k(),v("success","更新成功")}catch(s){c(s)}}async function A(){await f.logout(),v("success","您已登出"),T.push("/login")}return F(async()=>{try{await f.authCheck(),f.status||T.push("/login"),H.defaults.headers.common.Authorization=f.token,await k()}catch(e){c(e)}}),(e,s)=>(n(),l("div",O,[t("nav",null,[s[6]||(s[6]=t("a",{href:"#"},[t("img",{class:"logoImg_nav",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""})],-1)),t("ul",null,[t("li",R,[t("span",null,C(N(f).user)+"的代辦",1)]),t("li",null,[t("a",{href:"#",onClick:a(A,["prevent"])},"登出")])])]),t("div",G,[t("div",J,[t("div",K,[b(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=o=>h.value=o)},null,512),[[x,h.value]]),t("a",{href:"#",onClick:a(M,["prevent"])},s[7]||(s[7]=[t("i",{class:"fa fa-plus"},null,-1)]))]),t("div",Q,[t("ul",W,[t("li",null,[t("a",{href:"#",class:w(p.value.all),onClick:s[1]||(s[1]=a(o=>m("all"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:w(p.value.todo),onClick:s[2]||(s[2]=a(o=>m("todo"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:w(p.value.done),onClick:s[3]||(s[3]=a(o=>m("done"),["prevent"]))},"已完成",2)])]),t("div",X,[r.value.length===0?(n(),l("p",Y,"目前尚無待辦事項")):$("",!0),t("ul",Z,[(n(!0),l(P,null,j(V.value,o=>(n(),l("li",{key:o.id},[i.value&&i.value.id===o.id?(n(),l("label",tt,[b(t("input",{class:"todoList_input_edit",type:"text","onUpdate:modelValue":s[4]||(s[4]=u=>_.value=u)},null,512),[[x,_.value]])])):(n(),l("label",et,[b(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":u=>o.status=u,onChange:u=>U(o)},null,40,st),[[q,o.status]]),t("span",null,C(o.content),1)])),i.value&&i.value.id===o.id?(n(),l("div",ot,[t("a",{href:"#",onClick:a(u=>z(o),["prevent"])},s[8]||(s[8]=[t("i",{class:"fa-solid fa-circle-check fa-lg"},null,-1)]),8,nt),t("a",{href:"#",onClick:s[5]||(s[5]=a(u=>i.value=null,["prevent"]))},s[9]||(s[9]=[t("i",{class:"fa-solid fa-circle-xmark fa-lg"},null,-1)]))])):(n(),l("div",lt,[t("a",{href:"#",onClick:a(u=>S(o),["prevent"])},s[10]||(s[10]=[t("i",{class:"fa-solid fa-pen-to-square fa-lg"},null,-1)]),8,at),t("a",{href:"#",onClick:a(u=>E(o),["prevent"])},s[11]||(s[11]=[t("i",{class:"fa-solid fa-trash-can fa-lg"},null,-1)]),8,it)]))]))),128))]),r.value.length>0?(n(),l("div",ut,[t("p",null,C(B.value)+" 個待完成項目",1)])):$("",!0)])])])])]))}};export{ft as default};
